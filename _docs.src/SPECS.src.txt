AppTools: Specifications
-------------------------------------------------------
Updated: January 29, 2026
Version: 0.1.0

OVERVIEW
	AppTools is a set of Bash-based command-line tools for orchestrating common development and project management tasks within the monorepo. It replaces project-specific shell scripts with a unified toolset, ensuring consistency and simplifying maintenance.

	The tools operate as simple Bash scripts that respond to environment variables to determine their behavior for each target project. This lightweight approach provides flexibility without requiring complex configuration files.

	This document provides the technical specifications for the AppTools.

SYSTEM ARCHITECTURE

	Components
		- Project dispatcher script (Main Entry Point): The `project` script serves as a dispatcher, and the other major command/action script files are called with it, e.g., project deps <arguments ...>. If AppTools is installed locally, the project command should be available on the machine as an executable, so we can run it immediately. If not, we need to get it from Github and run it with sh it directly from its Github URL, with a command like curl -fsSL <url-to-project-script> | sh -s -- <command> <...arguments>. When the project script is invoked, it is passed the specific command script to run, and that command's arguments.

		- Core Tools: Individual Bash scripts for specific actions (deps, build, test, dev, start, deploy, install).

		- Environment Handler: The `_env` script loads variables from a `.env` file into the environment.

		- Utility Functions: Shared functions in `_utils` for consistent logging and error handling.

	Prerequisites
		- Bash shell
		- Standard Unix/Linux tools (curl, wget, tar, rsync, sed, openssl)
		- Git version control (for deployment and version operations)
		- PostgreSQL and SQLite database engines (if using database features)
		- Node.js runtime and package manager (pnpm/bun/npm - only for projects using Node.js)
		- Podman (Container Engine): For managing local development services that run in containers, such as MinIO (S3-compatible object storage) and MailHog (SMTP server). AppTools commands like `deps`, `start`, and `test` interact with Podman to ensure these services are available.
			Installation
			- macOS (via Homebrew): brew install podman && podman machine init && podman machine start
			- Linux: Refer to your distribution's documentation (e.g., `sudo apt install podman` for Debian/Ubuntu, `sudo dnf install podman` for Fedora).

	Execution Context
		The tools are designed to be executed from the root directory of a target project. They implicitly determine the current project context by reading a `.env` file (if present) and using environment variables to control their behavior. All operations are relative to the current working directory.

	Dynamic Recursive Loading
		As alluded to in the description of the project command, AppTools can work without being locally installed. The dispatcher script "project" can be loaded from its url and run with sh, and it in turn loads and uses any script files it needs that do not exist locally in a similar manner, and those script files also load/use any files they depend on a similar manner, etc.

		When executed remotely, the project script creates a temporary directory (or uses an existing local installation) and downloads all required scripts from the GitHub repository. The APPTOOLS_DIR_PATH environment variable is set to point to this directory, allowing all scripts to reference each other using relative paths like "$APPTOOLS_DIR_PATH/_utils". After execution, the temporary directory is cleaned up. This centralized approach ensures all scripts are consistently available and avoids redundant downloads.

	Script Invocation Principle
		Whenever a script (that is typically called with the "project" dispatcher) needs to call another of the scripts, it should do so directly, i.e., without again calling it with the "project" dispatcher. This avoids the overhead of the dispatcher and ensures proper argument passing without potential parsing issues.

	Directory Structure
		The AppTools project files are organized in a flat structure for simplicity and ease of installation:

		Root Directory:
			- project			# Main dispatcher script (executable)
			- deps				# Dependencies management (executable)
			- build				# Build automation (executable)
			- test				# Test execution (executable)
			- dev				# Development server with file watching (executable)
			- start				# Production server (executable)
			- deploy			# Deployment automation (executable)
			- install			# CLI tool installation (executable)
			- _env				# Environment variable loader (executable utility)
			- _utils			# Shared utility functions (executable utility)
			- _postgres			# PostgreSQL-specific database operations (executable utility)
			- _sqlite			# SQLite-specific database operations (executable utility)

		When installed locally, all files are placed in the installation directory (e.g., ~/.local/share/apptools/). A symlink to the main executable is created in ~/.local/bin/ for easy access.

		Internal Organization:
			- User-facing commands: Files without underscore prefixes (project, deps, build, etc.)
			- Internal utilities: Files with underscore prefixes (_env, _utils, _postgres, _sqlite)

COMMAND LINE INTERFACE

	Main Command: `project`
		Usage: project <action> [arguments]

		Behavior
			The `project` script is a dispatcher that:

			- Sets up a context for the command that is to be run. This requires sourcing the files _utils (to use shared functions) and _env (to load env variables from `.env` file if present). If AppTools is installed locally, then those files are in the same folder and can immediately be used. Otherwise, the project script needs to curl/wget them and source them, preferably in place without having to actually save them as files.

			- Sets a log folder and file path relative to any project folder it is running in. If it does not appear to be running at a project root (no package.json, etc) then no log folder/file path should be set, and no logging should occur.

			- Runs the action command, optionally logging its output, report the result, and exit. Again, if AppTools is installed locally, then the command script file exists, otherwise it needs to be loaded from its url in the apptools repo. The command script file also loads any files it depends on from their AppTools repo url as it runs.

@include commands.src.txt

INSTALLATION
	Apptools as a whole and its scripts are coded in such a way that it can use its install script to install itself. Apart from the install command, no other command in AppTools can be run on AppTools itself. The project is hosted at the remote git repo https://github.com/danfortsystems/apptools, with the following file structure:

@include envvars.src.txt

DEVELOPMENT

	Installation
		- Tools are copied to ~/.local/share/apptools/
		- A symlink is created at ~/.local/bin/project
		- One-liner installer available via curl script

	Deployment
		- Simple file-based deployment via deploy script
		- No build process required (scripts are Bash)
		- Tools remain executable without installation

	FUTURE ENHANCEMENTS

		Potential SMS Integration:
			- SMS_* environment variables for SMS testing configuration
			- Container-based SMS gateway or integration with Twilio
			- Environment variable control similar to other services
